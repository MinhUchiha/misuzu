$(function(){$.getJSON("/events",function(t){$("#calendar-month-view").fullCalendar({businessHours:{start:"09:00:00",end:"18:00:00",dow:[1,2,3,4,5]},firstDay:1,slotLabelFormat:["HH : mm"],scrollTime:"09:00:00",minTime:"09:00:00",googleCalendarApiKey:"AIzaSyDOeA5aJ29drd5dSAqv1TW8Dvy2zkYdsdk",eventSources:[{googleCalendarId:"en.japanese#holiday@group.v.calendar.google.com",color:"green"},{googleCalendarId:"en.vietnamese#holiday@group.v.calendar.google.com",color:"blue"}],schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",events:t.my_events,header:{left:"title",center:"month,agendaWeek,agendaDay prevYear,nextYear",right:"today prev,next"}}),$("#calendar-timeline").fullCalendar({height:1400,businessHours:{start:"09:00:00",end:"18:00:00",dow:[1,2,3,4,5]},firstDay:1,resourceAreaWidth:"35%",slotLabelFormat:["HH : mm"],scrollTime:"09:00:00",eventOverlap:!1,defaultView:"timelineDay",events:t.events,resourceGroupField:"shozoku",resourceColumns:[{labelText:"\u5f79\u8077",field:"yakushoku",width:75,render:function(t,e){e.css("background-color","#0070a3")}},{labelText:"\u793e\u54e1\u540d",field:"shain",width:60,render:function(t,e){e.css("background-color","seagreen")}},{labelText:"\u5185\u7dda",field:"linenum",width:25,render:function(t,e){e.css("background-color","#adadad")}},{labelText:"\u72b6\u614b",field:"joutai",width:50,render:function(t,e){e.css("background-color",t.background_color),e.css("color",t.text_color)}},{labelText:"\u4f1d\u8a00",field:"dengon",width:25,render:function(t,e){e.css("background-color","#adadad")}},{labelText:"\u56de\u89a7",field:"kairan",width:25,render:function(t,e){e.css("background-color","#adadad")}}],resources:t.shains}),$("#calendar-month-view").fullCalendar("addEventSource",t.holidays)})}),$(window).on("load",function(){$("#calendar-timeline").fullCalendar("render"),$("#goto-date-input").val(moment().format("YYYY/MM/DD"))}),$(function(){$("#toggle-calendar-goto").click(function(){$("#goto-date-input").data("DateTimePicker").toggle()}),$("#\u958b\u59cb").click(function(){$("#event_\u958b\u59cb").data("DateTimePicker").toggle()}),$("#\u7d42\u4e86").click(function(){$("#event_\u7d42\u4e86").data("DateTimePicker").toggle()})}),$(function(){$("#goto-date-input").datetimepicker({format:"YYYY/MM/DD",widgetPositioning:{horizontal:"left"},showTodayButton:!0,showClear:!0,calendarWeeks:!0,keyBinds:!1,focusOnShow:!1}),$("#event_\u958b\u59cb").datetimepicker({format:"YYYY/MM/DD HH:mm",showClear:!0,showTodayButton:!0,sideBySide:!0,calendarWeeks:!0,toolbarPlacement:"top",keyBinds:!1,focusOnShow:!1}),$("#event_\u7d42\u4e86").datetimepicker({format:"YYYY/MM/DD HH:mm",showTodayButton:!0,showClear:!0,sideBySide:!0,calendarWeeks:!0,toolbarPlacement:"top",keyBinds:!1,focusOnShow:!1}),$("#event_\u958b\u59cb").on("dp.change",function(t){$("#event_\u7d42\u4e86").data("DateTimePicker").minDate(t.date)}),$("#event_\u7d42\u4e86").on("dp.change",function(t){$("#event_\u958b\u59cb").data("DateTimePicker").maxDate(t.date)})}),$(function(){$("#goto-date-button").click(function(){date_input=$("#goto-date-input").val(),date=moment(date_input),$("#calendar-month-view").fullCalendar("gotoDate",date),$("#calendar-timeline").fullCalendar("gotoDate",date)}),$("#search_user").click(function(){$("#select_user_modal").modal("show")}),$("#joutai_search").click(function(){$("#joutai_search_modal").modal("show")}),$("#basho_search").click(function(){$("#basho_search_modal").modal("show")}),$("#koutei_search").click(function(){$("#koutei_search_modal").modal("show")}),$("#shozai_search").click(function(){$("#shozai_search_modal").modal("show")}),$("#job_search").click(function(){$("#job_search_modal").modal("show")}),$("#shujitu").click(function(){start_form_time=$("#event_\u958b\u59cb").val(),end_form_time=$("#event_\u7d42\u4e86").val();var t,e;return""==start_form_time&&""==end_form_time?(t=moment().format("YYYY-MM-DD"),e=t+" 18:00",t+=" 09:00",$("#event_\u958b\u59cb").val(t),void $("#event_\u7d42\u4e86").val(e)):(""!=start_form_time?(t=start_form_time.substring(0,10)+" 09:00",e=start_form_time.substring(0,10)+" 18:00"):(t=end_form_time.substring(0,10)+" 09:00",e=end_form_time.substring(0,10)+" 18:00"),$("#event_\u958b\u59cb").val(t),void $("#event_\u7d42\u4e86").val(e))}),$("#month-view").click(function(){$("#calendar-timeline").hide(),$("#calendar-month-view").show(),$("#calendar-month-view").fullCalendar("render")}),$("#day-view").click(function(){$("#calendar-month-view").hide(),$("#calendar-timeline").show()})}),$(function(){oTable=$("#user_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oBashoTable=$("#basho_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oJoutaiTable=$("#joutai_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oKouteiTable=$("#koutei_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oShozaiTable=$("#shozai_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oJobTable=$("#job_table").DataTable({pagingType:"simple_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"}}),oEventTable=$("#event_table").DataTable({pagingType:"full_numbers",oLanguage:{sUrl:"../../assets/resource/dataTable_ja.txt"},aoColumnDefs:[{aTargets:[0],mRender:function(t,e,n){return'<a href="/events/'+t+'/edit">\u8a73\u7d30</a>'}},{aTargets:[1,2],mRender:function(t,e,n){var r=moment(t,"YYYY-MM-DD HH:mm").format("YYYY-MM-DD HH:mm");return"Invalid date"!==r?r:""}},{bSortable:!1,aTargets:[0]},{targets:[0],searchable:!1}],order:[],columnDefs:[{targets:"no-sort",orderable:!1}],autoWidth:!0}),$("#user_table tbody").on("click","tr",function(){var t=oTable.row(this).data();$("#selected_user").val(t[0]),$("#selected_user_name").val(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oTable.$("tr.selected").removeClass("selected"),oTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success"))}),$("#basho_table tbody").on("click","tr",function(){var t=oBashoTable.row(this).data();$("#event_\u5834\u6240\u30b3\u30fc\u30c9").val(t[0]),$("#basho_name").text(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oBashoTable.$("tr.selected").removeClass("selected"),oBashoTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success"))}),$("#joutai_table tbody").on("click","tr",function(){var t=oJoutaiTable.row(this).data();$("#event_\u72b6\u614b\u30b3\u30fc\u30c9").val(t[0]),$("#joutai_name").text(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oJoutaiTable.$("tr.selected").removeClass("selected"),oJoutaiTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success")),"30"==t[0]?($("#event_\u5834\u6240\u30b3\u30fc\u30c9").prop("disabled",!0),$("#event_JOB").prop("disabled",!0),$("#event_\u5de5\u7a0b\u30b3\u30fc\u30c9").prop("disabled",!0),$("#basho_search").prop("disabled",!0),$("#koutei_search").prop("disabled",!0)):($("#event_\u5834\u6240\u30b3\u30fc\u30c9").prop("disabled",!1),$("#event_JOB").prop("disabled",!1),$("#event_\u5de5\u7a0b\u30b3\u30fc\u30c9").prop("disabled",!1),$("#basho_search").prop("disabled",!1),$("#koutei_search").prop("disabled",!1))}),$("#koutei_table tbody").on("click","tr",function(){var t=oKouteiTable.row(this).data();$("#event_\u5de5\u7a0b\u30b3\u30fc\u30c9").val(t[0]),$("#koutei_name").text(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oKouteiTable.$("tr.selected").removeClass("selected"),oKouteiTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success"))}),$("#shozai_table tbody").on("click","tr",function(){var t=oShozaiTable.row(this).data();$("#event_\u6240\u5728\u30b3\u30fc\u30c9").val(t[0]),$("#shozai_name").text(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oShozaiTable.$("tr.selected").removeClass("selected"),oShozaiTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success"))}),$("#job_table tbody").on("click","tr",function(){var t=oJobTable.row(this).data();$("#event_JOB").val(t[0]),$("#job_name").text(t[1]),$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).removeClass("success")):(oJobTable.$("tr.selected").removeClass("selected"),oJobTable.$("tr.success").removeClass("success"),$(this).addClass("selected"),$(this).addClass("success"))})}),$(function(){$(document).bind("ajaxError","form#new_kouteimaster",function(t,e,n,r){$(t.data).render_form_errors($.parseJSON(e.responseText))})}),function(t){t.fn.modal_success=function(){this.modal("hide"),this.find('form input[type="text"]').val(""),this.clear_previous_errors()},t.fn.render_form_errors=function(e){$form=this,this.clear_previous_errors(),model=this.data("model"),t.each(e,function(e,n){$input=t('input[name="'+model+"["+e+']"]'),$input.closest(".form-group").addClass("has-error").find(".help-block").html(n.join(" & "))})},t.fn.clear_previous_errors=function(){t(".form-group.has-error",this).each(function(){t(".help-block",t(this)).html(""),t(this).removeClass("has-error")})}}(jQuery),$(function(){$("#event_\u72b6\u614b\u30b3\u30fc\u30c9").keydown(function(t){if(9==t.keyCode&&!t.shiftKey){var e=$("#event_\u72b6\u614b\u30b3\u30fc\u30c9").val();jQuery.ajax({url:"/events/ajax",data:{id:"event_\u72b6\u614b\u30b3\u30fc\u30c9",event_joutai_code:e},type:"POST",success:function(t){$("#joutai_name").text(t.joutai_name),console.log("getAjax joutai_name:"+t.joutai_name)},failure:function(){console.log("event_\u72b6\u614b\u30b3\u30fc\u30c9 keydown Unsuccessful")}})}}),$("#event_\u5834\u6240\u30b3\u30fc\u30c9").keydown(function(t){if(9==t.keyCode&&!t.shiftKey){var e=$("#event_\u5834\u6240\u30b3\u30fc\u30c9").val();jQuery.ajax({url:"/events/ajax",data:{id:"event_\u5834\u6240\u30b3\u30fc\u30c9",event_basho_code:e},type:"POST",success:function(t){$("#basho_name").text(t.basho_name),console.log("getAjax basho_name:"+t.basho_name)},failure:function(){console.log("event_\u5834\u6240\u30b3\u30fc\u30c9 keydown Unsuccessful")}})}}),$("#event_\u5de5\u7a0b\u30b3\u30fc\u30c9").keydown(function(t){if(9==t.keyCode&&!t.shiftKey){var e=$("#event_\u5de5\u7a0b\u30b3\u30fc\u30c9").val();jQuery.ajax({url:"/events/ajax",data:{id:"event_\u5de5\u7a0b\u30b3\u30fc\u30c9",event_koutei_code:e},type:"POST",success:function(t){$("#koutei_name").text(t.koutei_name),console.log("getAjax koutei_name:"+t.koutei_name)},failure:function(){console.log("event_\u5de5\u7a0b\u30b3\u30fc\u30c9 keydown Unsuccessful")}})}}),$("#event_JOB").keydown(function(t){if(9==t.keyCode&&!t.shiftKey){var e=$("#event_JOB").val();jQuery.ajax({url:"/events/ajax",data:{id:"event_job",event_job_code:e},type:"POST",success:function(t){$("#job_name").text(t.job_name),console.log("getAjax job_name:"+t.job_name)},failure:function(){console.log("event_job\u756a\u53f7 keydown Unsuccessful")}})}})}),$(function(){$("#calendar-month-view").hide(),$("#calendar-timeline").show()});